<!DOCTYPE html>
<html lang="en-US">
  <head>
    <title>Timing Callbacks | abcjs</title><meta name="description" content="JavaScript library for displaying sheet music in a browser."><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="VuePress 2.0.0-beta.7">
    <link rel="preload" href="/abcjs/assets/js/runtime~app.4dfa3f90.js" as="script"><link rel="preload" href="/abcjs/assets/css/styles.80af813e.css" as="style"><link rel="preload" href="/abcjs/assets/js/310.c04019dd.js" as="script"><link rel="preload" href="/abcjs/assets/js/app.f2f640cf.js" as="script">
    <link rel="stylesheet" href="/abcjs/assets/css/styles.80af813e.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button"><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class=""></path></svg></div><span><a href="/abcjs/" class=""><img class="logo" src="/abcjs//img/abcjs_comp_extended_08.svg" alt="abcjs"><span class="site-name can-hide">abcjs</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><!----></div></header><div class="sidebar-mask"></div><aside class="sidebar"><!----><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><section class="sidebar-group"><p class="sidebar-heading">Overview</p><ul class=""><li><!--[--><a href="/abcjs/overview/purpose.html" class="nav-link sidebar-link" aria-label="Purpose"><!--[--><!--]--> Purpose <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/abcjs/overview/examples.html" class="nav-link sidebar-link" aria-label="Examples"><!--[--><!--]--> Examples <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/abcjs/overview/getting-started.html" class="nav-link sidebar-link" aria-label="Getting Started"><!--[--><!--]--> Getting Started <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/abcjs/overview/example-generator.html" class="nav-link sidebar-link" aria-label="Example Generator"><!--[--><!--]--> Example Generator <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/abcjs/overview/abc-notation.html" class="nav-link sidebar-link" aria-label="ABC Music Notation"><!--[--><!--]--> ABC Music Notation <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/abcjs/overview/faq.html" class="nav-link sidebar-link" aria-label="Frequently Asked Questions"><!--[--><!--]--> Frequently Asked Questions <!--[--><!--]--></a><!----><!--]--></li></ul></section><!--]--><!--[--><section class="sidebar-group"><p class="sidebar-heading">Visual</p><ul class=""><li><!--[--><a href="/abcjs/visual/overview.html" class="nav-link sidebar-link" aria-label="Overview (renderAbc)"><!--[--><!--]--> Overview (renderAbc) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/abcjs/visual/render-abc-options.html" class="nav-link sidebar-link" aria-label="RenderAbc options"><!--[--><!--]--> RenderAbc options <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/abcjs/visual/render-abc-result.html" class="nav-link sidebar-link" aria-label="return value of renderAbc"><!--[--><!--]--> return value of renderAbc <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/abcjs/visual/classes.html" class="nav-link sidebar-link" aria-label="Classes"><!--[--><!--]--> Classes <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/abcjs/visual/click-listener.html" class="nav-link sidebar-link" aria-label="Click Listener"><!--[--><!--]--> Click Listener <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/abcjs/visual/dragging.html" class="nav-link sidebar-link" aria-label="Selecting and Dragging Elements"><!--[--><!--]--> Selecting and Dragging Elements <!--[--><!--]--></a><!----><!--]--></li></ul></section><!--]--><!--[--><section class="sidebar-group"><p class="sidebar-heading">Audio</p><ul class=""><li><!--[--><a href="/abcjs/audio/synthesized-sound.html" class="nav-link sidebar-link" aria-label="Synthesized Sound"><!--[--><!--]--> Synthesized Sound <!--[--><!--]--></a><!----><!--]--></li></ul></section><!--]--><!--[--><section class="sidebar-group"><p class="sidebar-heading active">Animation</p><ul class=""><li><!--[--><a aria-current="page" href="/abcjs/animation/timing-callbacks.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-link active" aria-label="Timing Callbacks"><!--[--><!--]--> Timing Callbacks <!--[--><!--]--></a><ul class="sidebar-sub-headers"><li><!--[--><a aria-current="page" href="/abcjs/animation/timing-callbacks.html#creation" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Creation"><!--[--><!--]--> Creation <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/abcjs/animation/timing-callbacks.html#parameters" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Parameters"><!--[--><!--]--> Parameters <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/abcjs/animation/timing-callbacks.html#callbacks" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Callbacks"><!--[--><!--]--> Callbacks <!--[--><!--]--></a><ul class="sidebar-sub-headers"><li><!--[--><a aria-current="page" href="/abcjs/animation/timing-callbacks.html#beatcallback" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="beatCallback"><!--[--><!--]--> beatCallback <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/abcjs/animation/timing-callbacks.html#eventcallback" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="eventCallback"><!--[--><!--]--> eventCallback <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/abcjs/animation/timing-callbacks.html#lineendcallback" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="lineEndCallback"><!--[--><!--]--> lineEndCallback <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/abcjs/animation/timing-callbacks.html#functions" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Functions"><!--[--><!--]--> Functions <!--[--><!--]--></a><ul class="sidebar-sub-headers"><li><!--[--><a aria-current="page" href="/abcjs/animation/timing-callbacks.html#start-offsetpercent" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="start(offsetPercent)"><!--[--><!--]--> start(offsetPercent) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/abcjs/animation/timing-callbacks.html#pause" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="pause()"><!--[--><!--]--> pause() <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/abcjs/animation/timing-callbacks.html#stop" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="stop()"><!--[--><!--]--> stop() <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/abcjs/animation/timing-callbacks.html#reset" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="reset()"><!--[--><!--]--> reset() <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/abcjs/animation/timing-callbacks.html#setprogress-percent-units" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="setProgress(percent, units)"><!--[--><!--]--> setProgress(percent, units) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/abcjs/animation/timing-callbacks.html#replacetarget-visualobj" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="replaceTarget(visualObj)"><!--[--><!--]--> replaceTarget(visualObj) <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/abcjs/animation/timing-callbacks.html#example" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Example"><!--[--><!--]--> Example <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul></section><!--]--><!--[--><section class="sidebar-group"><p class="sidebar-heading">Interactive</p><ul class=""><li><!--[--><a href="/abcjs/interactive/interactive-editor.html" class="nav-link sidebar-link" aria-label="Interactive Editor"><!--[--><!--]--> Interactive Editor <!--[--><!--]--></a><!----><!--]--></li></ul></section><!--]--><!--[--><section class="sidebar-group"><p class="sidebar-heading">Analysis</p><ul class=""><li><!--[--><a href="/abcjs/analysis/tune-book.html" class="nav-link sidebar-link" aria-label="Tune Book"><!--[--><!--]--> Tune Book <!--[--><!--]--></a><!----><!--]--></li></ul></section><!--]--><!--[--><section class="sidebar-group"><p class="sidebar-heading">Deprecated</p><ul class=""><li><!--[--><a href="/abcjs/deprecated/deprecated-api.html" class="nav-link sidebar-link" aria-label="Deprecated API Calls"><!--[--><!--]--> Deprecated API Calls <!--[--><!--]--></a><!----><!--]--></li></ul></section><!--]--><!--[--><section class="sidebar-group"><p class="sidebar-heading">Developers</p><ul class=""><li><!--[--><a href="/abcjs/developers/pull-requests.html" class="nav-link sidebar-link" aria-label="Pull Requests"><!--[--><!--]--> Pull Requests <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/abcjs/developers/basic-architecture.html" class="nav-link sidebar-link" aria-label="Basic Architecture"><!--[--><!--]--> Basic Architecture <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/abcjs/developers/releasing.html" class="nav-link sidebar-link" aria-label="Releasing"><!--[--><!--]--> Releasing <!--[--><!--]--></a><!----><!--]--></li></ul></section><!--]--><!--[--><section class="sidebar-group"><p class="sidebar-heading">Upgrading</p><ul class=""><li><!--[--><a href="/abcjs/upgrading/release-notes.html" class="nav-link sidebar-link" aria-label="Release Notes"><!--[--><!--]--> Release Notes <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/abcjs/upgrading/midijs.html" class="nav-link sidebar-link" aria-label="MIDI.JS Usage"><!--[--><!--]--> MIDI.JS Usage <!--[--><!--]--></a><!----><!--]--></li></ul></section><!--]--><!--]--></ul><!--[--><!--]--></aside><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="timing-callbacks"><a class="header-anchor" href="#timing-callbacks">#</a> Timing Callbacks</h1><p>This runs an animation timer and does callbacks at various intervals. This allows you to do various effects that are timed with beats or playing notes.</p><h2 id="creation"><a class="header-anchor" href="#creation">#</a> Creation</h2><p>To use this create an instance of it:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> timingCallbacks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">abcjs<span class="token punctuation">.</span>TimingCallbacks</span><span class="token punctuation">(</span>visualObj<span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><table><thead><tr><th>Parameters</th><th>Description</th></tr></thead><tbody><tr><td>visualObj</td><td>This is the output of the <code>renderAbc()</code> call. It is the music that will be timed.</td></tr><tr><td>params</td><td>This is a object. See below for the possible properties.</td></tr></tbody></table><h2 id="parameters"><a class="header-anchor" href="#parameters">#</a> Parameters</h2><table><thead><tr><th>Name</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>qpm</code></td><td>whatever is in the Q: field</td><td>Number of beats per minute.</td></tr><tr><td><code>extraMeasuresAtBeginning</code></td><td>0</td><td>Don&#39;t start the callbacks right away, but insert this number of measures first.</td></tr><tr><td><code>beatCallback</code></td><td>null</td><td>Called for each beat passing the beat number (starting at 0).</td></tr><tr><td><code>eventCallback</code></td><td>null</td><td>Called for each event (either a note, a rest, or a chord, and notes in separate voices are grouped together.)</td></tr><tr><td><code>lineEndCallback</code></td><td>null</td><td>Called at the end of each line. (This is useful if you want to be sure the music is scrolled into view at the right time.) See <code>lineEndAnticipation</code> for more details.</td></tr><tr><td><code>lineEndAnticipation</code></td><td>0</td><td>The number of milliseconds for the <code>lineEndCallback</code> to anticipate end of the line. That is, if you want to get the callback half a second before the end of the line, use 500.</td></tr><tr><td><code>beatSubdivisions</code></td><td>1</td><td>How many callbacks should happen for each beat. This allows finer control in the client, for instance, to handle a progress bar.</td></tr></tbody></table><h2 id="callbacks"><a class="header-anchor" href="#callbacks">#</a> Callbacks</h2><h3 id="beatcallback"><a class="header-anchor" href="#beatcallback">#</a> beatCallback</h3><p>This is called once for every beat in the tune. It is called one additional time when the tune is finished.</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">beatCallback</span><span class="token punctuation">(</span><span class="token parameter">beatNumber<span class="token punctuation">,</span> totalBeats<span class="token punctuation">,</span> totalTime<span class="token punctuation">,</span> position<span class="token punctuation">,</span> debugInfo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>beatNumber</td><td>Zero-based beat number. Usually this will increment sequentially and regularly, but if javascript is paused long enough (for instance, if the browser tab is changed), then there may be a number of these calls at once when it catches up.</td></tr><tr><td>totalBeats</td><td>The total number of beats (including all repeats) that will be played.</td></tr><tr><td>totalTime</td><td>The total number of milliseconds of the tune.</td></tr><tr><td>position</td><td>The interpolated position of the cursor if the beat occurs between notes. This is an object with the attributes { left: , top: , height: } This can be used to smooth out the cursor by moving it on the beat callbacks. The higher the number of <code>beatSubdivisions</code> the smoother the cursor will be.</td></tr><tr><td>debugInfo</td><td>A hash of some extra info that might be useful in figuring out why the callback was triggered.</td></tr></tbody></table><h3 id="eventcallback"><a class="header-anchor" href="#eventcallback">#</a> eventCallback</h3><p>This is called once for every &quot;event&quot; in time - either a note or a rest. If there are multiple notes at the same time, then it is only called once for that group of notes.</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">eventCallback</span><span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>The parameter <code>ev</code> is an object that looks like this:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>ev <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;event&quot;</span><span class="token punctuation">,</span> <span class="token comment">// This is always &quot;event&quot;</span>

    <span class="token string">&quot;milliseconds&quot;</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token comment">// The number of milliseconds from the beginning of the piece</span>
    <span class="token string">&quot;millisecondsPerMeasure&quot;</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token comment">// The number of milliseconds per measure</span>

    <span class="token string">&quot;line&quot;</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token comment">// The current &quot;line&quot;, that is, the staff system.</span>
    <span class="token string">&quot;measureNumber&quot;</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token comment">// The measure number. Resets per line, so the first measure number on a line is zero.</span>

    <span class="token string">&quot;top&quot;</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token comment">// The number of pixels from the top of the svg that the note appears.</span>
    <span class="token string">&quot;height&quot;</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token comment">// The height of the note, in pixels. </span>
    <span class="token string">&quot;left&quot;</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token comment">// The number of pixels from the left edge of the svg.</span>
    <span class="token string">&quot;width&quot;</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token comment">// The width of the note</span>

    <span class="token string">&quot;elements&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// Array of the actual elements on the page that are represented by the note or notes.</span>
    <span class="token string">&quot;startCharArray&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> number <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// the character position in the original abc string</span>
    <span class="token string">&quot;endCharArray&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> number <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// the character position in the original abc string</span>
    <span class="token string">&quot;midiPitches&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// Array of the currently playing pitches</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;pitch&quot;</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token comment">// The pitch number (based on the midi standard, i.e. middle C is 60)</span>
            <span class="token string">&quot;durationInMeasures&quot;</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token comment">// the note value as a fraction. (that is, a quarter note is 0.025)</span>
            <span class="token string">&quot;volume&quot;</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token comment">// The volume expressed as a number between 0 and 127</span>
            <span class="token string">&quot;instrument&quot;</span><span class="token operator">:</span> number <span class="token comment">// The instrument number (based on the midi standard, i.e. acoustic_grand_piano is 0)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h4 id="notes"><a class="header-anchor" href="#notes">#</a> Notes:</h4><ul><li><p>The <code>startCharArray</code> and <code>endCharArray</code> are arrays because there is more than one location in the abc string if there is more than one voice.</p></li><li><p>The format of the <code>elements</code> array is subject to change in future versions.</p></li><li><p>This is called one last time with passing in <code>null</code> at the end of the tune. On that call <code>eventCallback</code> can return the string &quot;continue&quot; to keep the timer from stopping. This is useful if you want to play on repeat - in theory you would probably have another call to <code>seek()</code>.</p></li><li><p>This function can be a Promise or not.</p></li></ul><h3 id="lineendcallback"><a class="header-anchor" href="#lineendcallback">#</a> lineEndCallback</h3><p>This will be called as the cursor is approaching the end of a line of music. This is useful if there is more than a screen&#39;s worth of music; it can be used to scroll the page at the right time.</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">lineEndCallback</span><span class="token punctuation">(</span><span class="token parameter">info<span class="token punctuation">,</span> event<span class="token punctuation">,</span> details</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>The parameter <code>info</code> looks like this:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>info <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;milliseconds&quot;</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token comment">// current milliseconds from beginning of piece</span>
    <span class="token string">&quot;top&quot;</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token comment">// The number of pixels from the top of the svg to the top of the cursor</span>
    <span class="token string">&quot;bottom&quot;</span><span class="token operator">:</span> number <span class="token comment">// The number of pixels from the top of the svg to the bottom of the cursor</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>The parameter <code>event</code> is the standard note event.</p><p>The parameter <code>details</code> looks like this:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>details <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;line&quot;</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token comment">// the current line number (zero-based)</span>
    <span class="token string">&quot;endTimings&quot;</span><span class="token operator">:</span> array <span class="token comment">// the array of the timings for each line</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The <code>endTimings</code> array elements are of the same type as the <code>info</code> parameter.</p><h2 id="functions"><a class="header-anchor" href="#functions">#</a> Functions</h2><p>These are the entry points that can be called on the <code>timingCallbacks</code> object.</p><h3 id="start-offsetpercent"><a class="header-anchor" href="#start-offsetpercent">#</a> start(offsetPercent)</h3><p>This starts the timer that triggers the callbacks. This is called to both start and resume after calling pause.</p><table><thead><tr><th><code>offsetPercent</code> value</th><th>Description</th></tr></thead><tbody><tr><td>undefined</td><td>If the previous call was to <code>pause()</code>, then the animation continues from where it left off. If there was no pause, then the animation starts from the beginning.</td></tr><tr><td>From 0 to 1</td><td>The percentage into the animation to jump to. This is like doing a seek first.</td></tr></tbody></table><h3 id="pause"><a class="header-anchor" href="#pause">#</a> pause()</h3><p>Pauses the animation. Calling <code>start()</code> afterwards will resume from where it left off.</p><h3 id="stop"><a class="header-anchor" href="#stop">#</a> stop()</h3><p>Stop the animation. After calling this, the next call to <code>start()</code> will start at the beginning.</p><h3 id="reset"><a class="header-anchor" href="#reset">#</a> reset()</h3><p>Move the timer back to the beginning, so the animation starts over. This can be called either when the animation is currently running or when it is paused.</p><h3 id="setprogress-percent-units"><a class="header-anchor" href="#setprogress-percent-units">#</a> setProgress(percent, units)</h3><p>Change the position of the animation. This allows random access to any place in the tune.</p><p>If the second parameter is not present, then <code>units</code> equals &quot;percent&quot;. The possible values are:</p><ul><li><p><code>&quot;percent&quot;</code>: The percent passed in is a number between 0 and 1. This can be called either when the animation is currently running or when it is paused.</p></li><li><p><code>&quot;seconds&quot;</code>: The seconds from the beginning of the tune. If this is passed the end of the tune it is changed to the end.</p></li><li><p><code>&quot;beats&quot;</code>: The beats from the beginning of the tune. If this is passed the end of the tune it is changed to the end.</p></li></ul><h3 id="replacetarget-visualobj"><a class="header-anchor" href="#replacetarget-visualobj">#</a> replaceTarget(visualObj)</h3><p>If the underlying music changes on the fly, this replaces the current object without having to destroy the object and start over. <code>visualObj</code> is the return value from <code>renderAbc</code>.</p><h2 id="example"><a class="header-anchor" href="#example">#</a> Example</h2><p>Paste in any ABC you want here then click &quot;start&quot; to see what is returned by the timing callbacks:</p><div class="example-tune-book"><div class="abcjs-editor"><textarea id="abc"></textarea><div id="warnings"></div><div id="paper"></div></div></div><div class="timing-callbacks" data-v-d2ff8d54><form data-v-d2ff8d54><div class="language- my-code" data-v-d2ff8d54><div data-v-d2ff8d54>timer = new abcjs.TimingCallbacks(visualObj, {</div><label data-v-d2ff8d54><span data-v-d2ff8d54>qpm: </span><input type="number" min="4" max="300" step="4" value="100" data-v-d2ff8d54>, </label><label data-v-d2ff8d54><span data-v-d2ff8d54>extraMeasuresAtBeginning: </span><input type="number" min="0" max="4" value="0" data-v-d2ff8d54>, </label><label data-v-d2ff8d54><span data-v-d2ff8d54>lineEndAnticipation: </span><input type="number" min="0" max="4000" step="100" value="500" data-v-d2ff8d54>, </label><label data-v-d2ff8d54><span data-v-d2ff8d54>beatSubdivisions: </span><input type="number" min="1" max="8" value="4" data-v-d2ff8d54>, </label><div data-v-d2ff8d54></div><div class="label-indent" data-v-d2ff8d54>beatCallback: function() {...},</div><div class="label-indent" data-v-d2ff8d54>eventCallback: function() {...},</div><div class="label-indent" data-v-d2ff8d54>lineEndCallback: function() {...}</div><div data-v-d2ff8d54>}</div></div><button type="submit" data-v-d2ff8d54>Start()</button></form><button data-v-d2ff8d54>Stop()</button><button data-v-d2ff8d54>Pause()</button><button data-v-d2ff8d54>Reset()</button><button data-v-d2ff8d54>Set Progress(10)</button><div data-v-d2ff8d54><h3 data-v-d2ff8d54>Output Stream:</h3><div class="output" data-v-d2ff8d54></div></div></div><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">4/18/2021, 4:17:13 PM</span></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: paul@paulrosen.net">Paul Rosen</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main></div><!----><!--]--></div>
    <script src="/abcjs/assets/js/runtime~app.4dfa3f90.js" defer></script><script src="/abcjs/assets/js/310.c04019dd.js" defer></script><script src="/abcjs/assets/js/app.f2f640cf.js" defer></script>
  </body>
</html>
